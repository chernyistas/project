# Проект "Виджет банковских операций клиента"

## Описание:

Проект "Виджет банковских операций клиента" - это приложение на Python для выполнения различных задач, таких как
маскировка номеров кредитных карт и счетов клиентов банка.
Так же данный проект осуществляет сортировку транзакций по дате и по указанному значению (EXECUTED).
Есть функция, которая может сгенерировать номера карт в заданном диапазоне
от 0000 0000 0000 0001 до 9999 9999 9999 9999. Этот проект имеет функцию, которая
поочередно выдает транзакции, где валюта операции соответствует заданной (например, USD), также есть возможность
показывать описание каждой операции по очереди. В "Виджет банковских операций клиента" есть декоратор log, который
автоматически регистрирует детали выполнения функций, такие как имя функции, передаваемые аргументы,
результат выполнения и информация об ошибках. Это позволит обеспечить более глубокий контроль и анализ поведения
программы в процессе ее выполнения.

## Установка:

1. Клонируйте репозиторий:

```
git clone https://github.com/chernyistas/project.git
```

2. Установите зависимости:

```
pip install -r requirements.txt
```

## Использование

Проект предоставляет следующие основные функции:

- Фильтрация транзакций по состоянию
- Сортировка транзакций по дате
- Обработка различных сценариев и исключений
- Маскировка пластиковой карты или счета
- Генерация номеров для пластиковых карт в формате XXXX XXXX XXXX XXXX
- Поочередная выдача транзакции, где валюта операции соответствует заданной (например, USD)
- Возвращение описания каждой операции по очереди
- Автоматическое логирование начало и конца выполнения функции, а также ее результаты или возникшие ошибки

### Пример использования маскировки пластиковой карты или счета

На вход подается номер банковской карты - Card_name 1234 5678 8765 4321
или номер счета - Счет 12345678900987654321.
``
print(mask_account_card(номер счета или карты))  # Вывод: Card_name 1234 56** **** 4321  или Счет **4321 
``

### Пример сортировки транзакций по указанному значению (EXECUTED)

На вход подаются списки транзакций.
``
print(filter_by_state(список транзакций)) # Возвращаются списки транзакций только с значением (EXECUTED) - выполнено
``

### Пример сортировки по дате

На вход подаются списки транзакций.
``
print(sort_by_date(список транзакций)) # Возвращаются списки транзакций отсортированные по дате (по убыванию)
``

### Пример использования генерации номеров для пластиковых карт

````
for card_number in card_number_generator(1, 5):
    print(card_number)

>>> 0000 0000 0000 0001
    0000 0000 0000 0002
    0000 0000 0000 0003
    0000 0000 0000 0004
    0000 0000 0000 0005
````

### Пример использования функции, которая поочередно выдает транзакции

````
usd_transactions = filter_by_currency(transactions, "USD")
for _ in range(2):
    print(next(usd_transactions))

>>> {
          "id": 939719570,
          "state": "EXECUTED",
          "date": "2018-06-30T02:08:58.425572",
          "operationAmount": {
              "amount": "9824.07",
              "currency": {
                  "name": "USD",
                  "code": "USD"
              }
          },
          "description": "Перевод организации",
          "from": "Счет 75106830613657916952",
          "to": "Счет 11776614605963066702"
      }
      {
              "id": 142264268,
              "state": "EXECUTED",
              "date": "2019-04-04T23:20:05.206878",
              "operationAmount": {
                  "amount": "79114.93",
                  "currency": {
                      "name": "USD",
                      "code": "USD"
                  }
              },
              "description": "Перевод со счета на счет",
              "from": "Счет 19708645243227258542",
              "to": "Счет 75651667383060284188"
       }
````

### Пример возвращения описания каждой операции по очереди

````
descriptions = transaction_descriptions(transactions)
for _ in range(5):
    print(next(descriptions))

>>> Перевод организации
    Перевод со счета на счет
    Перевод со счета на счет
    Перевод с карты на карту
    Перевод организации
````

### Пример использования декоратора

````
@log(filename="mylog.txt")
def my_function(x, y):
    return x + y

my_function(1, 2)
````

Ожидаемый вывод в лог-файл
``
mylog.txt
``
при успешном выполнении:
``
my_function ok
``
Ожидаемый вывод при ошибке:
``
my_function error: тип ошибки. Inputs: (1, 2), {}
``
Где тип ошибки заменяется на текст ошибки.

## Тестирование

### Запуск тестов

Для запуска тестов выполните команду:
``
bash
pytest
``

### Структура тестов

Проект включает следующие типы тестов:

- Базовые тесты — проверка основной функциональности
- Тесты фикстур — проверка корректности тестовых данных
- Тесты исключений — проверка обработки ошибок
- Тесты граничных случаев — проверка крайних значений

### Покрытие тестами

Тестирование включает:

- Различные комбинации состояний транзакций
- Разные форматы дат
- Невалидные входные данные
- Отсутствующие ключи
- Граничные случаи сортировки
- Проверка на граничные значения
- Тест на корректную работу итератора
- Проверка работы с пустым списком
- Проверка фильтрации по определенной валюте
- Тесты на обработку ошибок с выводом в консоль
- Тесты на обработку ошибок с выводом в файл

### Пример использования фикстуры

```
@pytest.fixture
def transactions():
    return [
        {"id": 1, "state": "EXECUTED", "date": "2023-10-01"},
        {"id": 2, "state": "PENDING", "date": "2023-10-02"},
        {"id": 3, "state": "EXECUTED", "date": "2023-10-03"}
    ]
```

### Пример теста

```
def test_filter_by_state(tran   sactions):
    filtered = filter_by_state(transactions, "EXECUTED")
    assert len(filtered) == 2
    assert all(transaction["state"] == "EXECUTED" for transaction in filtered)
    
    
def test_card_number_generator_limit_value() -> None:
    # Проверка на граничное значение
    gen = card_number_generator(9999999999999999)
    assert next(gen) == "9999 9999 9999 9999"
```

### Пример теста на обработку ошибок с выводом в консоль

````
def test_error_console(capsys: pytest.CaptureFixture) -> None:
    with pytest.raises(ValueError):
        function_error(-1, 2)
    captured = capsys.readouterr()
    assert "function_error error: Negative value" in captured.out
    assert "Inputs: (-1, 2), {}" in captured.out

````

## Документация:

Дополнительную информацию о проекте можно найти в [документации](/README.md).

## Лицензия

Проект распространяется под лицензией MIT. Подробности в файле LICENSE.

